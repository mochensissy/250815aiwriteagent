<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APIè¿æ¥æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 25px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background: #fafafa;
        }
        .test-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .test-name {
            font-weight: 600;
            font-size: 16px;
        }
        .test-status {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }
        .status-pending {
            background: #f3f4f6;
            color: #6b7280;
        }
        .status-testing {
            background: #fef3c7;
            color: #d97706;
        }
        .status-success {
            background: #d1fae5;
            color: #065f46;
        }
        .status-error {
            background: #fee2e2;
            color: #dc2626;
        }
        .test-result {
            margin-top: 10px;
            padding: 10px;
            background: white;
            border-radius: 4px;
            font-size: 14px;
            border-left: 4px solid #e5e7eb;
        }
        .result-success {
            border-left-color: #10b981;
            background: #f0fdf4;
        }
        .result-error {
            border-left-color: #ef4444;
            background: #fef2f2;
        }
        .run-all-btn {
            display: block;
            width: 100%;
            padding: 12px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            margin-bottom: 30px;
            transition: background-color 0.2s;
        }
        .run-all-btn:hover {
            background: #2563eb;
        }
        .run-all-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        .summary {
            text-align: center;
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            margin-top: 20px;
        }
        pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 12px;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª AIå†™ä½œåŠ©æ‰‹ - APIè¿æ¥æµ‹è¯•</h1>
        
        <button id="runAllBtn" class="run-all-btn" onclick="runAllTests()">
            ğŸš€ è¿è¡Œæ‰€æœ‰APIæµ‹è¯•
        </button>

        <div id="geminiTest" class="test-section">
            <div class="test-header">
                <div class="test-name">ğŸ¤– Gemini API (æ–‡æœ¬ç”Ÿæˆ)</div>
                <div id="geminiStatus" class="test-status status-pending">å¾…æµ‹è¯•</div>
            </div>
            <div class="test-description">Google Geminiå¤§æ¨¡å‹APIï¼Œç”¨äºç”Ÿæˆæ–‡ç« å¤§çº²å’Œå†…å®¹</div>
            <div id="geminiResult" class="test-result" style="display: none;"></div>
        </div>

        <div id="perplexityTest" class="test-section">
            <div class="test-header">
                <div class="test-name">ğŸ” Perplexity API (å¤–éƒ¨æœç´¢)</div>
                <div id="perplexityStatus" class="test-status status-pending">å¾…æµ‹è¯•</div>
            </div>
            <div class="test-description">Perplexityæœç´¢APIï¼Œç”¨äºè·å–å¤–éƒ¨ä¿¡æ¯å¢å¼ºæ–‡ç« å†…å®¹</div>
            <div id="perplexityResult" class="test-result" style="display: none;"></div>
        </div>

        <div id="doubaoTest" class="test-section">
            <div class="test-header">
                <div class="test-name">ğŸ¨ è±†åŒ…ç”Ÿå›¾API (å›¾ç‰‡ç”Ÿæˆ)</div>
                <div id="doubaoStatus" class="test-status status-pending">å¾…æµ‹è¯•</div>
            </div>
            <div class="test-description">è±†åŒ…ç”Ÿå›¾APIï¼Œç”¨äºç”Ÿæˆæ–‡ç« é…å›¾å’Œå°é¢</div>
            <div id="doubaoResult" class="test-result" style="display: none;"></div>
        </div>

        <div id="summary" class="summary" style="display: none;">
            <h3>ğŸ“Š æµ‹è¯•ç»“æœæ€»ç»“</h3>
            <div id="summaryContent"></div>
        </div>
    </div>

    <script>
        let testResults = {};
        let isRunning = false;

        // æ›´æ–°æµ‹è¯•çŠ¶æ€
        function updateStatus(testName, status, message = '', result = null) {
            const statusEl = document.getElementById(`${testName}Status`);
            const resultEl = document.getElementById(`${testName}Result`);
            
            statusEl.className = `test-status status-${status}`;
            
            switch(status) {
                case 'pending':
                    statusEl.textContent = 'å¾…æµ‹è¯•';
                    break;
                case 'testing':
                    statusEl.textContent = 'æµ‹è¯•ä¸­...';
                    break;
                case 'success':
                    statusEl.textContent = 'âœ… æˆåŠŸ';
                    break;
                case 'error':
                    statusEl.textContent = 'âŒ å¤±è´¥';
                    break;
            }
            
            if (message) {
                resultEl.style.display = 'block';
                resultEl.className = `test-result result-${status === 'success' ? 'success' : 'error'}`;
                resultEl.innerHTML = `
                    <div><strong>ç»“æœ:</strong> ${message}</div>
                    ${result ? `<pre>${JSON.stringify(result, null, 2)}</pre>` : ''}
                `;
            }
            
            testResults[testName] = { status, message, result };
        }

        // æµ‹è¯•Gemini API
        async function testGemini() {
            updateStatus('gemini', 'testing');
            
            try {
                const response = await fetch('https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-goog-api-key': 'AIzaSyAH-wepOrQu0ujJfeqbcz2Pn7wHHvLihxg'
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: 'è¯·ç®€å•å›å¤"Gemini APIè¿æ¥æˆåŠŸ"ï¼Œä¸è¦æ·»åŠ å…¶ä»–å†…å®¹ã€‚'
                            }]
                        }]
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    const result = data.candidates?.[0]?.content?.parts?.[0]?.text || '';
                    updateStatus('gemini', 'success', `APIè¿æ¥æˆåŠŸï¼Œè¿”å›å†…å®¹: ${result.substring(0, 100)}`, {
                        responseTime: `${Date.now() - window.testStartTime}ms`,
                        contentLength: result.length
                    });
                    return true;
                } else {
                    const errorText = await response.text();
                    updateStatus('gemini', 'error', `HTTP ${response.status}: ${response.statusText}`, { errorDetails: errorText });
                    return false;
                }
            } catch (error) {
                updateStatus('gemini', 'error', `ç½‘ç»œé”™è¯¯: ${error.message}`, { error: error.toString() });
                return false;
            }
        }

        // æµ‹è¯•Perplexity API
        async function testPerplexity() {
            updateStatus('perplexity', 'testing');
            
            try {
                const response = await fetch('https://api.perplexity.ai/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer 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'
                    },
                    body: JSON.stringify({
                        model: 'sonar-medium-online',
                        messages: [
                            {
                                role: 'system',
                                content: 'Be precise and concise.'
                            },
                            {
                                role: 'user',
                                content: 'è¯·ç®€å•å›å¤"Perplexity APIè¿æ¥æˆåŠŸ"'
                            }
                        ],
                        max_tokens: 100,
                        temperature: 0.5
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    const result = data.choices?.[0]?.message?.content || '';
                    updateStatus('perplexity', 'success', `APIè¿æ¥æˆåŠŸï¼Œè¿”å›å†…å®¹: ${result.substring(0, 100)}`, {
                        responseTime: `${Date.now() - window.testStartTime}ms`,
                        contentLength: result.length
                    });
                    return true;
                } else {
                    const errorText = await response.text();
                    updateStatus('perplexity', 'error', `HTTP ${response.status}: ${response.statusText}`, { errorDetails: errorText });
                    return false;
                }
            } catch (error) {
                updateStatus('perplexity', 'error', `ç½‘ç»œé”™è¯¯: ${error.message}`, { error: error.toString() });
                return false;
            }
        }

        // æµ‹è¯•è±†åŒ…ç”Ÿå›¾API
        async function testDoubao() {
            updateStatus('doubao', 'testing');
            
            try {
                const response = await fetch('https://ark.cn-beijing.volces.com/api/v3/images/generations', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': 'Bearer ca9d6a48-f76d-4c29-a621-2cf259a55b2f'
                    },
                    body: JSON.stringify({
                        model: 'doubao-seedream-3-0-t2i-250415',
                        prompt: 'ä¸€æœµç®€å•çš„çº¢è‰²ç«ç‘°èŠ±ï¼Œç™½è‰²èƒŒæ™¯ï¼Œç®€çº¦é£æ ¼',
                        response_format: 'url',
                        size: '512x512',
                        guidance_scale: 3,
                        watermark: true
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    const imageUrl = data.data?.[0]?.url || '';
                    if (imageUrl) {
                        updateStatus('doubao', 'success', `å›¾ç‰‡ç”ŸæˆæˆåŠŸ: ${imageUrl}`, {
                            responseTime: `${Date.now() - window.testStartTime}ms`,
                            imageUrl: imageUrl
                        });
                        return true;
                    } else {
                        updateStatus('doubao', 'error', 'è¿”å›æ•°æ®ä¸­æ²¡æœ‰å›¾ç‰‡URL', data);
                        return false;
                    }
                } else {
                    const errorText = await response.text();
                    updateStatus('doubao', 'error', `HTTP ${response.status}: ${response.statusText}`, { errorDetails: errorText });
                    return false;
                }
            } catch (error) {
                updateStatus('doubao', 'error', `ç½‘ç»œé”™è¯¯: ${error.message}`, { error: error.toString() });
                return false;
            }
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        async function runAllTests() {
            if (isRunning) return;
            
            isRunning = true;
            window.testStartTime = Date.now();
            
            const runBtn = document.getElementById('runAllBtn');
            runBtn.disabled = true;
            runBtn.textContent = 'ğŸ”„ æµ‹è¯•è¿›è¡Œä¸­...';
            
            // é‡ç½®æ‰€æœ‰çŠ¶æ€
            ['gemini', 'perplexity', 'doubao'].forEach(test => {
                updateStatus(test, 'pending');
                document.getElementById(`${test}Result`).style.display = 'none';
            });
            
            document.getElementById('summary').style.display = 'none';
            
            console.log('ğŸš€ å¼€å§‹APIè¿æ¥æµ‹è¯•...');
            
            // å¹¶è¡Œè¿è¡Œæ‰€æœ‰æµ‹è¯•
            const results = await Promise.allSettled([
                testGemini(),
                testPerplexity(),
                testDoubao()
            ]);
            
            // æ˜¾ç¤ºæ€»ç»“
            const successCount = results.filter(r => r.status === 'fulfilled' && r.value).length;
            const totalCount = results.length;
            
            const summaryEl = document.getElementById('summary');
            const summaryContentEl = document.getElementById('summaryContent');
            
            summaryEl.style.display = 'block';
            summaryContentEl.innerHTML = `
                <div style="font-size: 18px; margin-bottom: 10px;">
                    ${successCount === totalCount ? 'ğŸ‰' : 'âš ï¸'} 
                    ${successCount}/${totalCount} é¡¹æµ‹è¯•é€šè¿‡
                </div>
                <div style="color: #6b7280;">
                    æ€»è€—æ—¶: ${Date.now() - window.testStartTime}ms
                </div>
                ${successCount === totalCount 
                    ? '<div style="color: #059669; margin-top: 10px;">âœ… æ‰€æœ‰APIæœåŠ¡æ­£å¸¸ï¼Œå¯ä»¥å¼€å§‹ä½¿ç”¨åº”ç”¨ï¼</div>'
                    : '<div style="color: #dc2626; margin-top: 10px;">âŒ éƒ¨åˆ†APIæœåŠ¡å¼‚å¸¸ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIå¯†é’¥é…ç½®</div>'
                }
            `;
            
            console.log(`ğŸ“Š æµ‹è¯•å®Œæˆ: ${successCount}/${totalCount} é¡¹é€šè¿‡`);
            
            runBtn.disabled = false;
            runBtn.textContent = 'ğŸ”„ é‡æ–°æµ‹è¯•';
            isRunning = false;
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„æç¤º
        window.addEventListener('load', () => {
            console.log('ğŸ’¡ APIæµ‹è¯•é¡µé¢å·²åŠ è½½ï¼Œç‚¹å‡»"è¿è¡Œæ‰€æœ‰APIæµ‹è¯•"æŒ‰é’®å¼€å§‹æµ‹è¯•');
        });
    </script>
</body>
</html>

